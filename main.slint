import { Button, VerticalBox, TabWidget, ScrollView, HorizontalBox,     DatePickerPopup, LineEdit } from "std-widgets.slint";
import "./dalmoorli.ttf";
import {DashBoard, PlantNameValue, PlantValue, PlantName} from "dash.slint";
import {KnobCapture, SpinBox, Blinker, Counter, KnobLineEdit, KnobButton} from "components.slint";
import { VirtualKeyboard } from "keyboard.slint";
import { edit } from "edit.slint";

import { KeyboardWindowLogic } from "keyboard_service.slint";
import { KeyboardWindow } from "keyboard_window.slint";

export { KeyboardWindow, KeyboardWindowLogic }



component SmallTabWidget inherits VerticalLayout {
    alignment: stretch;
    spacing: 1px;
    in property <[{name: string, id: int}]> tabs: [
        {name: "대시보드", id: 0},
        {name: "식물 수정", id: 1},
        {name: "컴포넌트 테스트", id: 2}
    ];
    in-out property <int> selected: 0;
    VerticalLayout {
        vertical-stretch: 0.0;
        spacing: 0px;
        tab_bar := HorizontalLayout {
            height: 8px;
            alignment: LayoutAlignment.start;
            vertical-stretch: 0.0;
            KnobCapture { // the tab selector
                cursors: true;
                text: root.tabs[root.selected].name;
                accessible-role: AccessibleRole.tab-list;
                accessible-action-increment => {
                    root.selected = Math.mod(root.selected + 1, root.tabs.length);
                }
                accessible-action-decrement => {
                    root.selected = Math.mod(root.selected + root.tabs.length - 1, root.tabs.length);
                }
            }
        }
        Rectangle {
            background: black;
            height: 1px;
        }
    }
    if root.selected == 0: DashBoard{
        visible: root.selected == 0;
    }
    if root.selected == 1: edit{}
    if root.selected == 2: VerticalLayout {
        Text {
            wrap: TextWrap.word-wrap;
            text: "컴포넌트 테스트용 화면입니다";
        }
        KnobLineEdit {
            text: "키보드 입력 테스트";
        }
        KnobLineEdit {
            text: "비밀번호 입력 테스트";
            input-type: password;
        }
    }
}

export component EmbeddedUI inherits Window {
    x <=> KeyboardWindowLogic.window_offset_x;
    y <=> KeyboardWindowLogic.window_offset_y;
    width: 128px;
    height: 64px;
    default-font-family: "dalmoori";
    default-font-size: 8px;
    //ScrollView {
        SmallTabWidget {
            width: 128px;
            height: 64px;
        }
    //}

    timer := Timer {
        interval: 0.5s;
        triggered => {
            Blinker.high = !Blinker.high;
        }
    }
    Timer {
        interval: 0.2s;
        triggered => {
            Counter.count = Math.mod((Counter.count + 1), 100) + 1;//1 to 100
        }
    }

}
